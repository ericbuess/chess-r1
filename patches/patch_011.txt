PATCH 011
Timestamp: 2025-09-18T19:40:59.276Z
Source: 6e537a4c-0e0a-4b96-a685-3d920e7780bd.jsonl:581
File: /Users/ericbuess/Projects/chess-r1/app/src/main.js
Replace All: False
============================================================

OLD STRING:
----------------------------------------
  // Convert display coordinates to logical coordinates based on board flip
  getLogicalCoordinates(displayRow, displayCol) {
    // Only apply coordinate reversal for modes that need it:
    // - Bot games when human plays black (no CSS rotation, just coordinate reversal)
    // - Table mode (CSS rotation + coordinate reversal)
    // - NOT handoff mode (CSS rotation only, no coordinate reversal)
    const needsCoordinateReversal = this.game.boardFlipped &&
                                    this.game.orientationMode !== 'handoff';

    if (needsCoordinateReversal) {
      return {
        row: 7 - displayRow,
        col: 7 - displayCol
      };
    }
    return { row: displayRow, col: displayCol };
  }

  // Convert logical coordinates to display coordinates based on board flip
  getDisplayCoordinates(logicalRow, logicalCol) {
    // Only apply coordinate reversal for modes that need it:
    // - Bot games when human plays black (no CSS rotation, just coordinate reversal)
    // - Table mode (CSS rotation + coordinate reversal)
    // - NOT handoff mode (CSS rotation only, no coordinate reversal)
    const needsCoordinateReversal = this.game.boardFlipped &&
                                    this.game.orientationMode !== 'handoff';

    if (needsCoordinateReversal) {
      return {
        row: 7 - logicalRow,
        col: 7 - logicalCol
      };
    }
    return { row: logicalRow, col: logicalCol };
  }
----------------------------------------

NEW STRING:
----------------------------------------
  // Convert display coordinates to logical coordinates based on board flip
  getLogicalCoordinates(displayRow, displayCol) {
    // Apply coordinate reversal based on game mode:
    // - Bot games: Always use coordinate reversal when boardFlipped (black at bottom)
    // - Table mode: Use coordinate reversal (with CSS rotation)
    // - Handoff mode: NO coordinate reversal (CSS rotation only)
    // - None mode in human-vs-human: No reversal
    const isBotGame = this.game.gameMode === 'human-vs-bot';
    const isTableMode = this.game.orientationMode === 'table';
    const needsCoordinateReversal = this.game.boardFlipped &&
                                    (isBotGame || isTableMode);

    if (needsCoordinateReversal) {
      return {
        row: 7 - displayRow,
        col: 7 - displayCol
      };
    }
    return { row: displayRow, col: displayCol };
  }

  // Convert logical coordinates to display coordinates based on board flip
  getDisplayCoordinates(logicalRow, logicalCol) {
    // Apply coordinate reversal based on game mode:
    // - Bot games: Always use coordinate reversal when boardFlipped (black at bottom)
    // - Table mode: Use coordinate reversal (with CSS rotation)
    // - Handoff mode: NO coordinate reversal (CSS rotation only)
    // - None mode in human-vs-human: No reversal
    const isBotGame = this.game.gameMode === 'human-vs-bot';
    const isTableMode = this.game.orientationMode === 'table';
    const needsCoordinateReversal = this.game.boardFlipped &&
                                    (isBotGame || isTableMode);

    if (needsCoordinateReversal) {
      return {
        row: 7 - logicalRow,
        col: 7 - logicalCol
      };
    }
    return { row: logicalRow, col: logicalCol };
  }
----------------------------------------
